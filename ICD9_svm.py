import numpy as np
import pandas as pd

#need to 'conda install flask' for this to work
from flask import Flask, abort, jsonify, request
import pickle
from sklearn.feature_extraction.text import TfidfVectorizer
from sklearn.preprocessing import StandardScaler
import requests, json

my_svm = pickle.load(open('icd9_svm.pkl', 'rb'))
scaler = pickle.load(open('scaler.sav', 'rb'))

app = Flask(__name__)

@app.route('/api', methods=['POST'])
def make_predict():
    #all kinds of error checking should go here
    jsondata = request.get_json(force=True)
    # request.get_json() this function already load jsondata


    # input data transform
    df = pd.DataFrame(jsondata, index=[0])

    v = TfidfVectorizer()

    X = v.fit_transform(df['sentences']).toarray()

    convoDF = pd.DataFrame() # Initialize new DF

    for i, col in enumerate(v.get_feature_names()):
        convoDF[col] = X[:, i]

    # get training data column
    col_header = ['00', '01', '04', '05', '09', '0cm', '10', '100', '101', '102', '103', '104', '105', '11', '12', '13', '134', '14', '15','16', '17', '18', '180', '19', '1st', '20', '2001', '21', '22', '23', '24', '25', '26', '27', '28', '29', '2nd', '30', '38', '3mm', '3rd', '45', '50', '591', '5th', '786', '85', '8year', '90s', '90th', '95th', 'abdomen', 'abdominal', 'abnormal', 'abnormalities', 'abnormality', 'about', 'above', 'abrasions', 'abscess', 'absence', 'absent', 'accidents', 'according', 'account', 'accounts', 'acquired', 'active', 'activity', 'actually', 'acute', 'addition', 'additional', 'adenoids', 'adenopathy', 'adequately', 'adherent', 'adjacent', 'administration', 'admissions', 'admitted', 'adopted', 'adults', 'aerated', 'aeration', 'afebrile', 'after', 'afternoon', 'again', 'age', 'agent', 'ago', 'air', 'airspace', 'airway', 'airways', 'albuterol', 'aldrich', 'all', 'allergies', 'allowing', 'almost', 'along', 'also', 'alternatively', 'although', 'ambulation', 'amenable', 'amount', 'amplatzer', 'amy', 'an', 'analysis', 'anatomic', 'and', 'anechoic', 'angle', 'angles', 'angulation', 'anniversary', 'annual', 'anomalies', 'anomaly', 'antenatal', 'anterior', 'anteriorly', 'antibiotic', 'antibiotics', 'antibody', 'antrum', 'anuresis', 'any', 'aorta', 'aortic', 'ap', 'apart', 'apparent', 'apparently', 'appear', 'appearance', 'appearances', 'appeared', 'appearing', 'appears', 'appendicitis', 'appetite', 'appreciated', 'appropriate', 'approximate', 'approximately', 'arch', 'are', 'area', 'areas', 'arm', 'around', 'arrest', 'artery', 'artifact', 'artificial', 'aryepiglottic', 'as', 'aside', 'aspect', 'aspirated', 'aspirating', 'aspiration', 'assess', 'assessing', 'associated', 'assuming', 'assure', 'ast', 'asthma', 'asthmatic', 'asymmetric', 'asymmetrically', 'asymmetry', 'asymptomatic', 'at', 'atelectasis', 'atelectatic', 'athens', 'atrophic', 'atrophy', 'attempted', 'attending', 'attenuation', 'atypical', 'augmentation', 'augmented', 'autism', 'av', 'available', 'average', 'axillary', 'azygos', 'back', 'bacterial', 'bactrim', 'band', 'barium', 'barky', 'base', 'based', 'baseline', 'bases', 'basilar', 'basis', 'basketball', 'bcg', 'be', 'because', 'beckwith', 'become', 'bedwetting', 'been', 'before', 'beginning', 'behavior', 'behind', 'being', 'below', 'beneficial', 'bertin', 'best', 'bethesda', 'better', 'between', 'bibasilar', 'bidirectional', 'bifid', 'bifida', 'bilateral', 'bilaterality', 'bilaterally', 'birth', 'bladder', 'bodies', 'body', 'bone', 'bones', 'bony', 'border', 'borderline', 'borders', 'borne', 'both', 'bowel', 'boy', 'brain', 'breast', 'breath', 'breathing', 'breathlessness', 'breaths', 'bronchial', 'bronchiectasis', 'bronchiectatic', 'bronchiolitis', 'bronchitis', 'broncho', 'bronchopulmonary', 'bronchospastic', 'bronchovascular', 'brothers', 'bruise', 'burning', 'but', 'by', 'cage', 'calcific', 'calcification', 'calcifications', 'calcified', 'calcium', 'calculi', 'calculus', 'caliber', 'caliceal', 'calices', 'caliectasis', 'calix', 'call', 'called', 'calms', 'calyceal', 'calyx', 'came', 'can', 'canal', 'cannot', 'capacity', 'car', 'cardiac', 'cardiopulmonary', 'care', 'cartilage', 'cartilaginous', 'case', 'catches', 'cath', 'catheter', 'catheterization', 'catheterized', 'catheters', 'caudal', 'cause', 'caused', 'causing', 'cell', 'cells', 'center', 'central', 'centrally', 'cervical', 'cf', 'chair', 'change', 'changed', 'changes', 'characteristics', 'characterized', 'charts', 'check', 'checkup', 'chest', 'child', 'chlorine', 'choking', 'cholelithiasis', 'chronic', 'chronological', 'clean', 'clear', 'cleared', 'clearing', 'clearly', 'clinic', 'clinical', 'clinically', 'clinician', 'clips', 'cloacal', 'close', 'clot', 'cm', 'coarctation', 'coarse', 'coating', 'code', 'coffee', 'coils', 'coin', 'cold', 'coli', 'collapse', 'collapsed', 'collecting', 'collection', 'collections', 'colon', 'column', 'combination', 'community', 'comparative', 'compared', 'comparison', 'comparisons', 'compatible', 'compensatory', 'complaining', 'complains', 'complete', 'completely', 'complex', 'complicating', 'complication', 'complications', 'component', 'compressing', 'compression', 'concentric', 'concern', 'concerning', 'configuration', 'confirmed', 'confluence', 'confluent', 'congenital', 'congested', 'congestion', 'connect', 'consequence', 'consider', 'considerably', 'consideration', 'considerations', 'considered', 'consistent', 'consolidation', 'consolidations', 'consolidative', 'constipation', 'consultation', 'containing', 'context', 'continue', 'continued', 'continues', 'contour', 'contralateral', 'contrast', 'controlled', 'converter', 'convex', 'conveyed', 'cord', 'correlate', 'correlated', 'correlation', 'cortex', 'cortical', 'corticomedullary', 'costochondral', 'costophrenic', 'cough', 'coughing', 'could', 'count', 'couple', 'course', 'crackles', 'creates', 'cries', 'croup', 'croupy', 'crowding', 'ct', 'cuffing', 'cul', 'curing', 'current', 'currently', 'curvature', 'curve', 'cyst', 'cystic', 'cystitis', 'cystogram', 'cystograms', 'cystography', 'cystoscopy', 'cystourethrogram', 'cystourethrograms', 'cysts', 'daily', 'date', 'dated', 'dating', 'day', 'days', 'daytime', 'de', 'debris', 'decompression', 'decrease', 'decreased', 'decreasing', 'decubitus', 'dedicated', 'deep', 'definable', 'defined', 'definite', 'definitive', 'deflux', 'deformity', 'degenerative', 'degree', 'degrees', 'dehydrated', 'dehydration', 'delayed', 'demonstrate', 'demonstrated', 'demonstrating', 'denise', 'dense', 'densities', 'density', 'department', 'dependent', 'depending', 'derivative', 'descending', 'described', 'despite', 'detailed', 'details', 'detected', 'detection', 'determine', 'determined', 'developed', 'developing', 'development', 'deviation', 'deviations', 'device', 'diagnosed', 'diagnosis', 'diameter', 'diaphragm', 'diaphragmatic', 'diaphragms', 'diarrhea', 'dictation', 'did', 'difference', 'differences', 'different', 'differential', 'differentiation', 'difficult', 'difficulty', 'diffuse', 'diffusely', 'dilatation', 'dilated', 'dilation', 'diminished', 'direct', 'disappearance', 'discoid', 'discomfort', 'discontinued', 'discovered', 'discrepancy', 'discussed', 'discussion', 'disease', 'displaced', 'distal', 'distended', 'distention', 'distorted', 'diverticulum', 'do', 'document', 'documented', 'documenting', 'does', 'done', 'donor', 'double', 'down', 'drainage', 'drained', 'dramatically', 'dribbling', 'dry', 'due', 'duodenal', 'duplex', 'duplicated', 'duplication', 'duplications', 'duration', 'during', 'dysfunction', 'dysplasia', 'dysplastic', 'dyspnea', 'dysraphism', 'dysuria', 'each', 'ear', 'earlier', 'early', 'easily', 'echoes', 'echogenic', 'echogenicity', 'echotexture', 'ectasia', 'ectopic', 'ectopically', 'edema', 'edematous', 'effect', 'effects', 'effort', 'effusion', 'effusions', 'eight', 'eighteen', 'either', 'elbowed', 'elevated', 'elevation', 'eleven', 'elsewhere', 'emergency', 'emesis', 'employed', 'empties', 'empty', 'emptying', 'empyema', 'end', 'endovascular', 'endplate', 'ends', 'enlarged', 'enlargement', 'ensure', 'entirely', 'enuresis', 'epiglottis', 'episode', 'episodes', 'epispadias', 'esophageal', 'esophagus', 'especially', 'essentially', 'etc', 'ethmoid', 'etiology', 'evaluate', 'evaluated', 'evaluating', 'evaluation', 'even', 'every', 'evidence', 'evident', 'exaggeration', 'exam', 'examination', 'examinations', 'examined', 'exams', 'excavatum', 'exceeds', 'except', 'exclude', 'excluded', 'excretion', 'exercise', 'existing', 'expanded', 'expected', 'expiratory', 'explain', 'explained', 'explanation', 'exposure', 'exstrophy', 'extending', 'extension', 'extent', 'extrarenal', 'extremely', 'fahrenheit', 'failure', 'falling', 'familiar', 'family', 'fat', 'fatigue', 'favor', 'favored', 'features', 'febrile', 'feeding', 'feel', 'feeling', 'feels', 'fell', 'fellow', 'felt', 'female', 'fetal', 'fever', 'fevers', 'few', 'fibrosis', 'fifth', 'file', 'filed', 'filled', 'filling', 'film', 'films', 'final', 'finding', 'findings', 'finished', 'fire', 'first', 'fistula', 'five', 'flank', 'flattened', 'flattening', 'flow', 'fluffy', 'fluid', 'focal', 'foci', 'focus', 'fold', 'folds', 'follicle', 'follow', 'following', 'followup', 'food', 'for', 'foreign', 'former', 'foster', 'found', 'four', 'fourchette', 'fourth', 'fracture', 'fractured', 'fractures', 'frank', 'free', 'frequency', 'frequent', 'frightened', 'from', 'frontal', 'fulguration', 'full', 'fullness', 'fully', 'function', 'functional', 'funny', 'further', 'gagging', 'gas', 'gaseous', 'gasps', 'gastrocystoplasty', 'gastrostomy', 'generalized', 'gets', 'gi', 'girl', 'give', 'given', 'glenn', 'global', 'globally', 'glomerulonephritis', 'got', 'gotten', 'grade', 'grades', 'granuloma', 'granulomatous', 'great', 'greater', 'greatly', 'grew', 'gross', 'grossly', 'growing', 'grown', 'growth', 'habitus', 'had', 'half', 'has', 'have', 'having', 'hazy', 'he', 'head', 'healing', 'heart', 'height', 'held', 'helpful', 'hemangioma', 'hematuria', 'hemidiaphragm', 'hemidiaphragms', 'hemihypertrophy', 'hemithorax', 'hemorrhage', 'hemorrhagic', 'her', 'hernia', 'herself', 'high', 'higher', 'hila', 'hilar', 'hilum', 'him', 'his', 'histoplasma', 'history', 'hit', 'hoarse', 'hodgkin', 'homogeneous', 'horseshoe', 'hospital', 'hospitalization', 'hours', 'house', 'however', 'hugely', 'hurts', 'hydrated', 'hydrational', 'hydronephrosi', 'hydronephrosis', 'hydronephrotic', 'hydroureter', 'hydroureteronephrosis', 'hyperdense', 'hyperechoic', 'hyperinflated', 'hyperinflation', 'hyperreactive', 'hypertrophy', 'hypoechoic', 'hypoplasia', 'hypoplastic', 'hypospadias', 'hypovascularity', 'hypoventilation', 'hypoventilatory', 'icd', 'identified', 'identify', 'if', 'ii', 'iii', 'ileus', 'ill', 'illness', 'image', 'images', 'imaging', 'immediately', 'immunodeficiency', 'implant', 'implantation', 'implants', 'impressed', 'impression', 'improved', 'improvement', 'improving', 'in', 'inaccurate', 'incidental', 'incidentally', 'include', 'included', 'includes', 'including', 'incomplete', 'incontinence', 'increase', 'increased', 'increases', 'increasing', 'indicate', 'indicated', 'indicates', 'indistinctness', 'infancy', 'infant', 'infection', 'infections', 'inferior', 'infiltrate', 'infiltrates', 'inflammation', 'inflammatory', 'inflation', 'information', 'informative', 'infrahilar', 'infundibular', 'ingested', 'initial', 'initially', 'injection', 'injections', 'injury', 'inlet', 'inner', 'inserted', 'insertions', 'inspiration', 'inspiratory', 'institution', 'insufficient', 'intact', 'intercostal', 'intermittent', 'intermittently', 'internal', 'interobserver', 'interpretation', 'interstitial', 'interval', 'interventional', 'into', 'intraabdominal', 'intraluminal', 'intraoperative', 'intrarenal', 'intrathoracic', 'intrauterine', 'intrinsically', 'intussusception', 'involves', 'involving', 'irregular', 'irregularities', 'irregularity', 'is', 'issue', 'it', 'ivp', 'jan', 'january', 'jet', 'jets', 'junction', 'junctional', 'just', 'keeping', 'kidney', 'kidneys', 'kilograms', 'kilovoltage', 'known', 'kyphosis', 'l10', 'l5', 'laboratory', 'labored', 'lack', 'large', 'larger', 'last', 'lateral', 'least', 'left', 'leftward', 'length', 'lengths', 'lesion', 'less', 'lethargy', 'leukemia', 'level', 'levels', 'lie', 'like', 'likely', 'limited', 'limiting', 'limits', 'line', 'linear', 'lines', 'lingual', 'lingula', 'lingular', 'lining', 'lithotripsy', 'little', 'liver', 'lobar', 'lobe', 'lobes', 'lobulated', 'lobulation', 'localized', 'located', 'location', 'long', 'longer', 'loop', 'loops', 'loss', 'lousy', 'low', 'lower', 'lucencies', 'lucent', 'lumbar', 'lumen', 'lunch', 'lung', 'lungs', 'lymph', 'lymphadenopathy', 'lymphocytic', 'made', 'mainly', 'malaise', 'male', 'malformation', 'malpositioned', 'management', 'margin', 'margins', 'marked', 'markedly', 'markings', 'marrow', 'mason', 'mass', 'masses', 'massive', 'massively', 'matched', 'material', 'maxillary', 'maximal', 'may', 'maybe', 'mean', 'measurable', 'measure', 'measured', 'measurement', 'measurements', 'measures', 'measuring', 'meatal', 'medial', 'mediastinal', 'mediastinum', 'medical', 'medication', 'medicine', 'megaureter', 'megaureters', 'meningomyelocele', 'mentally', 'merely', 'microscopic', 'micturition', 'mid', 'middle', 'mild', 'mildly', 'minimal', 'minimally', 'minor', 'minus', 'missed', 'mitral', 'mitrofanoff', 'mm', 'mobile', 'modality', 'moderate', 'moderately', 'moieties', 'moiety', 'mom', 'monday', 'month', 'months', 'more', 'morning', 'morphologic', 'most', 'mother', 'mound', 'mounds', 'mri', 'mucosal', 'multi', 'multicystic', 'multifocal', 'multiple', 'murmur', 'muscular', 'must', 'myalgia', 'mycoplasma', 'myelomeningocele', 'name', 'narrowing', 'nasal', 'nasopharyngeal', 'nature', 'near', 'nearly', 'neck', 'need', 'needed', 'negative', 'neither', 'nephrectomy', 'nephrocalcinosis', 'nephrolithiasis', 'nephrology', 'nephropathy', 'nephrostomy', 'neurogenic', 'new', 'newborn', 'next', 'night', 'nights', 'nighttime', 'nine', 'nipple', 'no', 'nocturnal', 'nodes', 'nodular', 'nodule', 'noisy', 'noncomplicated', 'nonconventional', 'nondilated', 'nondistended', 'none', 'nonfebrile', 'nonobstructed', 'nonobstructing', 'nonobstructive', 'nonspecific', 'noonan', 'nor', 'normal', 'normalize', 'normally', 'nose', 'not', 'notable', 'note', 'noted', 'notified', 'nov', 'now', 'nuclear', 'number', 'numerous', 'objected', 'obscuring', 'obstructing', 'obstruction', 'obstructions', 'obtain', 'obtained', 'obtaining', 'obvious', 'occurred', 'of', 'off', 'office', 'official', 'old', 'omphalocele', 'on', 'one', 'only', 'onset', 'opacification', 'opacities', 'opacity', 'opens', 'operation', 'operative', 'or', 'order', 'ordering', 'organism', 'origin', 'ossified', 'osteosarcoma', 'other', 'otherwise', 'our', 'out', 'outer', 'outpatient', 'outside', 'ovarian', 'ovary', 'over', 'overall', 'overlying', 'pain', 'painless', 'palatine', 'palmer', 'parallel', 'parameters', 'paranasal', 'paratracheal', 'parenchyma', 'parenchymal', 'parent', 'parents', 'partial', 'partially', 'particularly', 'passage', 'passed', 'past', 'patch', 'patchiness', 'patchy', 'patent', 'patient', 'pattern', 'pectus', 'pelves', 'pelvic', 'pelvicaliceal', 'pelvicalyceal', 'pelvis', 'per', 'percentile', 'performed', 'perhaps', 'peribronchial', 'perihilar', 'perinephric', 'perineum', 'period', 'periphery', 'peristalsis', 'persist', 'persisted', 'persistent', 'persistently', 'persists', 'pertussis', 'pharyngitis', 'phases', 'phone', 'physical', 'physician', 'physiologic', 'picture', 'pituitary', 'place', 'placement', 'placements', 'plain', 'plate', 'please', 'pleural', 'plus', 'pm', 'pneumococcal', 'pneumomediastinum', 'pneumonia', 'pneumonias', 'pneumothorax', 'pole', 'poles', 'polycystic', 'polyp', 'poor', 'poorly', 'portion', 'position', 'positional', 'positioned', 'positioning', 'positive', 'possibility', 'possible', 'possibly', 'post', 'posterior', 'posteriorly', 'posteromedial', 'postnatal', 'postoperative', 'postpneumonic', 'postsurgical', 'postvoid', 'potty', 'ppd', 'practice', 'pre', 'pregnancy', 'pregnant', 'preliminary', 'prenatal', 'preoperative', 'presence', 'present', 'presentations', 'presented', 'presenting', 'presents', 'preservation', 'presumably', 'presumed', 'previous', 'previously', 'prior', 'probable', 'probably', 'problems', 'procedure', 'procedures', 'proceeded', 'process', 'progressed', 'progression', 'progressive', 'projection', 'prolapse', 'prolonged', 'prominence', 'prominent', 'prone', 'protein', 'proteinuria', 'provided', 'proximal', 'proximally', 'proximity', 'pulmonary', 'pulmonologist', 'punctate', 'puncture', 'punctured', 'purified', 'purpose', 'pyelectasis', 'pyelitis', 'pyelocaliectasis', 'pyelocalyceal', 'pyelonephritis', 'pyeloplasty', 'pyloroplasty', 'pyramids', 'quadrant', 'query', 'question', 'questionable', 'quite', 'r5', 'r9', 'racing', 'radiating', 'radiograph', 'radiographic', 'radiographically', 'radiographs', 'radiologist', 'radiology', 'radiopaque', 'raise', 'raised', 'raises', 'raising', 'rales', 'range', 'rankin', 'rate', 'rather', 'ray', 'rays', 're', 'reaction', 'reactive', 'reactor', 'read', 'real', 'reanastomosis', 'reason', 'receive', 'received', 'recent', 'recently', 'recommend', 'recommendation', 'recommended', 'reconstruction', 'record', 'recurrent', 'redness', 'reevaluate', 'referred', 'referring', 'refill', 'reflect', 'reflecting', 'reflects', 'reflux', 'region', 'regions', 'regression', 'reimplant', 'reimplantation', 'reimplants', 'related', 'relative', 'relatively', 'release', 'relieved', 'remain', 'remainder', 'remaining', 'remains', 'removal', 'removed', 'renal', 'repair', 'repaired', 'repeat', 'replaced', 'report', 'reported', 'reportedly', 'reports', 'represent', 'representative', 'representing', 'represents', 'requested', 'requesting', 'required', 'resection', 'residua', 'residual', 'residue', 'resolution', 'resolved', 'resolves', 'resolving', 'respiration', 'respiratory', 'respond', 'resultant', 'results', 'retained', 'retention', 'retraction', 'retractions', 'retrocardiac', 'retroperitoneal', 'retropharyngeal', 'reveal', 'revealed', 'reviewing', 'rhonchi', 'rib', 'ribs', 'right', 'rightward', 'ring', 'room', 'rotated', 'rotation', 'round', 'rounded', 'routine', 'row', 'rsv', 'rule', 'ruled', 'running', 'runny', 'ruptured', 'sac', 'said', 'same', 'satisfactory', 'saturations', 'scan', 'scanning', 'scapular', 'scar', 'scarred', 'scarring', 'scattered', 'scheduled', 'school', 'scintigraphy', 'scoliosis', 'screening', 'seat', 'second', 'secondary', 'secretions', 'see', 'seen', 'segment', 'segmental', 'segmentation', 'seizure', 'senegal', 'sensitivity', 'sent', 'separate', 'septated', 'septation', 'sequela', 'setting', 'seven', 'seventeen', 'several', 'severe', 'shadow', 'shadowing', 'shadows', 'shaped', 'sharp', 'she', 'short', 'shorter', 'shortness', 'should', 'shoulder', 'show', 'showed', 'showing', 'shown', 'shows', 'sibling', 'siblings', 'sick', 'sickle', 'side', 'sided', 'sigmoid', 'signed', 'significance', 'significant', 'significantly', 'signify', 'signifying', 'signs', 'silhouette', 'silhouettes', 'silhouetting', 'similar', 'similarly', 'simple', 'since', 'single', 'sinus', 'sinuses', 'sinusitis', 'site', 'six', 'sixteen', 'size', 'sized', 'sizes', 'skin', 'sleeping', 'slight', 'slightly', 'slow', 'small', 'smaller', 'smoking', 'so', 'soft', 'solitary', 'some', 'sometimes', 'somewhat', 'sonogram', 'sonographic', 'sonographically', 'sonography', 'soon', 'sore', 'sounds', 'source', 'space', 'spasm', 'specifically', 'specified', 'spike', 'spina', 'spinal', 'spine', 'spleen', 'splinting', 'spontaneous', 'sports', 'spring', 'spurious', 'spurring', 'sputum', 'stability', 'stable', 'stage', 'standard', 'standards', 'standing', 'stands', 'start', 'started', 'starting', 'stasis', 'stated', 'states', 'status', 'stenosis', 'stent', 'stents', 'sternal', 'sternotomy', 'sternum', 'still', 'stomach', 'stone', 'stones', 'stool', 'straight', 'stranding', 'streaky', 'strong', 'structural', 'structure', 'structures', 'studied', 'studies', 'study', 'stuffy', 'stump', 'subclavian', 'subcutaneous', 'subglottic', 'subsegmental', 'subsequent', 'subsequently', 'substance', 'subtle', 'such', 'sudden', 'suggest', 'suggested', 'suggesting', 'suggestion', 'suggestive', 'suggests', 'sulcus', 'superimposed', 'superimposition', 'superior', 'superiorly', 'supine', 'support', 'supported', 'supporting', 'suppressive', 'suprahilar', 'suprapubic', 'sure', 'surgery', 'surgical', 'surgically', 'surveillance', 'suspect', 'suspected', 'suspicion', 'suspicious', 'swallow', 'sweats', 'swelling', 'symmetric', 'symptomatology', 'symptoms', 'syncytial', 'syndrome', 'system', 'systems', 'table', 'tables', 'tachypnea', 'taken', 'taking', 'talks', 'tb', 'tear', 'technical', 'technique', 'telephone', 'temperature', 'ten', 'tenderness', 'tennessee', 'tenting', 'term', 'test', 'tethered', 'than', 'thanksgiving', 'that', 'the', 'their', 'then', 'therapy', 'there', 'therefore', 'thereof', 'these', 'they', 'thickened', 'thickening', 'thinned', 'thinning', 'third', 'thirteen', 'this', 'thoracic', 'thoracolumbar', 'thoracotomy', 'thorax', 'though', 'thought', 'three', 'threshold', 'throat', 'through', 'thymus', 'thyroid', 'tightening', 'tightness', 'time', 'times', 'tiny', 'tissue', 'tissues', 'titer', 'tnf', 'to', 'today', 'toilet', 'tonsils', 'took', 'tortuosity', 'tortuous', 'towards', 'toxic', 'trabeculated', 'trabeculation', 'trabeculations', 'trace', 'trachea', 'tracheal', 'tracheitis', 'tracheoesophageal', 'tracheomalacia', 'track', 'tract', 'traction', 'train', 'trained', 'transient', 'transplant', 'transplants', 'transurethral', 'transverse', 'trapping', 'trauma', 'travel', 'treated', 'treatment', 'triangular', 'triplet', 'trisomy', 'true', 'tube', 'tuberculosis', 'tubes', 'tumor', 'tumors', 'turner', 'twelve', 'twenty', 'two', 'uganda', 'uk', 'ultrasound', 'ultrasounds', 'uncertain', 'unchanged', 'unclear', 'uncommon', 'uncomplicated', 'under', 'underlying', 'unequal', 'unilateral', 'university', 'unknown', 'unless', 'unremarkable', 'unsure', 'unusual', 'unwell', 'up', 'upper', 'upright', 'urachus', 'ureter', 'ureteral', 'ureterectasis', 'ureteric', 'ureterocele', 'ureteroceles', 'ureteropelvic', 'ureteropyeloplasty', 'ureterostomy', 'ureteroureterostomy', 'ureterovesical', 'ureters', 'urethral', 'urge', 'urgency', 'uri', 'urinalysis', 'urinary', 'urinated', 'urination', 'urine', 'urinoma', 'uroepithelial', 'urogenital', 'urolithiasis', 'urologic', 'urology', 'urothelial', 'us', 'useful', 'usually', 'utero', 'uti', 'utilized', 'utis', 'vacuum', 'vagina', 'vaginal', 'vague', 'valuable', 'value', 'valve', 'valves', 'variability', 'variable', 'variant', 'variation', 'varies', 'vascular', 'vascularity', 'veins', 'venous', 'versus', 'vertebral', 'very', 'vesicostomy', 'vesicoureteral', 'vesicoureteric', 'vesicular', 'vessels', 'via', 'view', 'views', 'viral', 'virus', 'visible', 'visit', 'visualization', 'visualized', 'voice', 'void', 'voided', 'voiding', 'voids', 'volume', 'volumes', 'vomited', 'vomiting', 'vs', 'vsd', 'walking', 'wall', 'walls', 'waning', 'warranted', 'was', 'wash', 'watched', 'waxing', 'we', 'weakness', 'web', 'wedge', 'wedging', 'week', 'weekend', 'weeks', 'weight', 'well', 'were', 'wet', 'wetting', 'what', 'wheeze', 'wheezing', 'when', 'where', 'whether', 'which', 'while', 'white', 'who', 'whooping', 'whose', 'wiedemann', 'will', 'williams', 'wilms', 'wilson', 'window', 'wires', 'wiskott', 'with', 'within', 'without', 'woman', 'work', 'workup', 'worrisome', 'worse', 'worsening', 'worthwhile', 'would', 'wrestling', 'x1', 'x2', 'x3', 'x4', 'x5', 'xray', 'year', 'yearly', 'years', 'yesterday', 'zithromax', 'zone']


    dff = pd.DataFrame(columns=col_header)

    sent = dff.append(convoDF)
    sent = sent.fillna(0)
    
    x_s = scaler.transform(sent)

    #np array goes into svm model, prediction comes out
    predicted = my_svm.predict(x_s)
    #return our prediction
    output = {'ICD9 code': predicted[0]}
    print(jsondata)
    print(output)
    return jsonify(results=output)

if __name__ == '__main__':
    app.run(port = 9000, debug = True)
